define("nuomi/main",["require","jquery","common/js/Remoter","etpl","./nuomi.tpl"],function(require){function e(e){f.compile(d),u(e).html(f.render("nuomi-title")),t()}function t(){u(".ibx-nuomi-mine").on("click",function(){l(u(this)),u("#ibx-nuomi").html(f.render("nuomi-loading")),h.remote()}),u(".ibx-nuomi-deal").on("click",function(){l(u(this)),u("#ibx-nuomi").html(f.render("nuomi-loading")),p.remote()}),i(),u(".ibx-nuomi-mine").trigger("click"),s()}function i(){h.on("success",function(e){if(u(".ibx-nuomi-mine").hasClass("current"))u(".nuomi-link-more").css("display","none"),m=190,v=e,u("#ibx-nuomi").html(f.render("nuomi-mine")),n()}).on("fail",function(){u("#ibx-nuomi").html(f.render("loading-error"))}),p.on("success",function(e){if(u(".ibx-nuomi-deal").hasClass("current"))u(".nuomi-link-more").css("display","block"),m=226,y=e,u("#ibx-nuomi").html(f.render("nuomi-deal",{title:y.t10_period,link:y.t10_loc})),r()}).on("fail",function(){u("#ibx-nuomi").html(f.render("loading-error"))})}function n(){var e=v.list.length;g.boxWidth=Math.ceil(u("#nuomi-mine-hot-main").width()+10),g.centerNum=Math.floor(g.boxWidth/190),g.dataLength=e>=3?e:e+1;var t=o(g.dataLength);u("#nuomi-mine-hot-main").html(f.render("nuomi-mine-hot-list",{width:t,list:v.list}))}function r(){if(g.boxWidth=Math.ceil(u("#nuomi-deal-main").width()+10),g.centerNum=Math.floor(g.boxWidth/226),y.list.length>40)y.list.length=40;g.dataLength=y.list.length;var e=o(g.dataLength);u("#nuomi-deal-main").html(f.render("nuomi-deal-list",{width:e,list:a(y.list)})),u(".nuomi-deal-list-item-bottom").on("click",function(){u(this).parents("li").find(".nuomi-deal-item-link")[0].click()})}function a(e){return u.each(e,function(e,t){var i=30;t.short_medium_title=t.medium_title.length>i?t.medium_title.substring(0,i)+"...":t.medium_title}),e}function o(e){var t=Math.ceil(e/g.centerNum);if(e)u("#ibx-nuomi .ibx-card-pager").html(f.render("nuomi-pager",{length:new Array(t)})),u(".ibx-nuomi-mask").toggleClass("hidden",1===t);return t*g.boxWidth}function s(){u("#ibx-mod-nuomi").on("click",".ibx-card-pager-item",function(){var e=u(this).closest(".ibx-card-pager"),t=+u(this).attr("data-page");if(!u(this).hasClass("current"))e.find(".ibx-card-pager-item").removeClass("current"),u(this).addClass("current"),u(".nuomi-normal-list").animate({left:-m*g.centerNum*t+"px"},1e3)}),u("#ibx-mod-nuomi").on("click",".ibx-card-pager-prev",function(){var e=u(this).closest(".ibx-card-pager"),t=+e.find(".ibx-card-pager-item.current").attr("data-page")-1;t>-1&&e.find(".ibx-card-pager-item:eq("+t+")").trigger("click")}),u("#ibx-mod-nuomi").on("click",".ibx-card-pager-next",function(){var e=u(this).closest(".ibx-card-pager"),t=+e.find(".ibx-card-pager-item.current").attr("data-page")+1;t!==e.find(".ibx-card-pager-item").length&&e.find(".ibx-card-pager-item:eq("+t+")").trigger("click")})}function l(e){u("#ibx-mod-nuomi .ibx-inner-title-tabitem").removeClass("current"),e.addClass("current")}var u=require("jquery"),c=require("common/js/Remoter"),f=require("etpl"),d=require("./nuomi.tpl"),h=new c("HOME_NUOMI_PRO"),p=new c("HOME_NUOMI_DEAL"),g={},m=0,y=null,v=null;return u(window).resize(function(){var e=u(".nuomi-mine-hot-mian").width()||u("#ibx-nuomi").width();g.boxWidth=Math.ceil(e),g.centerNum=Math.floor((g.boxWidth+20)/m),g.dataLength&&o(g.dataLength)}),{render:e}}),define("nuomi",["nuomi/main"],function(e){return e});